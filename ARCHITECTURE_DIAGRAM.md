# Authentication Architecture Diagram

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (React + Vite)                      â”‚
â”‚                         http://localhost:5173                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚  LoginCard.jsx â”‚         â”‚  AuthContext.jsx â”‚                    â”‚
â”‚  â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚                    â”‚
â”‚  â”‚  - Formik Form â”‚         â”‚  - login()       â”‚                    â”‚
â”‚  â”‚  - Validation  â”‚         â”‚  - logout()      â”‚                    â”‚
â”‚  â”‚  - API calls   â”‚         â”‚  - token storage â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚           â”‚                           â”‚                               â”‚
â”‚           â”‚                           â”‚                               â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                           â”‚                                           â”‚
â”‚                     [axios calls]                                     â”‚
â”‚                           â”‚                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP Requests
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND (Node.js + Express)                     â”‚
â”‚                         http://localhost:5000                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    server.js (Main Entry)                    â”‚    â”‚
â”‚  â”‚  - Express setup                                             â”‚    â”‚
â”‚  â”‚  - CORS configuration                                        â”‚    â”‚
â”‚  â”‚  - Middleware                                                â”‚    â”‚
â”‚  â”‚  - Route mounting                                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                   â”‚                                                   â”‚
â”‚                   â–¼                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              routes/authRoutes.js (Routes)                   â”‚    â”‚
â”‚  â”‚  POST /api/auth/register                                     â”‚    â”‚
â”‚  â”‚  POST /api/auth/login                                        â”‚    â”‚
â”‚  â”‚  POST /api/auth/google                                       â”‚    â”‚
â”‚  â”‚  GET  /api/auth/me                                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                   â”‚                                                   â”‚
â”‚                   â–¼                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         controllers/authController.js (Business Logic)       â”‚    â”‚
â”‚  â”‚                                                               â”‚    â”‚
â”‚  â”‚  register():                                                 â”‚    â”‚
â”‚  â”‚    1. Validate input                                         â”‚    â”‚
â”‚  â”‚    2. Check existing user                                    â”‚    â”‚
â”‚  â”‚    3. Hash password (bcrypt)                                 â”‚    â”‚
â”‚  â”‚    4. Create user in DB                                      â”‚    â”‚
â”‚  â”‚    5. Generate JWT token                                     â”‚    â”‚
â”‚  â”‚                                                               â”‚    â”‚
â”‚  â”‚  login():                                                    â”‚    â”‚
â”‚  â”‚    1. Validate input                                         â”‚    â”‚
â”‚  â”‚    2. Find user (User or Vendor)                             â”‚    â”‚
â”‚  â”‚    3. Compare password (bcrypt)                              â”‚    â”‚
â”‚  â”‚    4. Generate JWT token                                     â”‚    â”‚
â”‚  â”‚                                                               â”‚    â”‚
â”‚  â”‚  me():                                                       â”‚    â”‚
â”‚  â”‚    1. Verify JWT token                                       â”‚    â”‚
â”‚  â”‚    2. Find user by ID                                        â”‚    â”‚
â”‚  â”‚    3. Return user data                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                   â”‚                                                   â”‚
â”‚                   â–¼                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                   models/ (Database Models)                  â”‚    â”‚
â”‚  â”‚                                                               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚   User.js         â”‚         â”‚    Vendor.js         â”‚     â”‚    â”‚
â”‚  â”‚  â”‚                   â”‚         â”‚                      â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  - name           â”‚         â”‚  - role              â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  - email          â”‚         â”‚  - email             â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  - password       â”‚         â”‚  - password          â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  - googleId       â”‚         â”‚  - companyName       â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  - timestamps     â”‚         â”‚  - gst, addresses    â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  - social links      â”‚     â”‚    â”‚
â”‚  â”‚                                 â”‚  - status            â”‚     â”‚    â”‚
â”‚  â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Mongoose ODM
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MongoDB Database                              â”‚
â”‚                    mongodb://localhost:27017/saasorbit               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  users collection   â”‚         â”‚  vendors collection  â”‚           â”‚
â”‚  â”‚  {                  â”‚         â”‚  {                   â”‚           â”‚
â”‚  â”‚    _id,             â”‚         â”‚    _id,              â”‚           â”‚
â”‚  â”‚    name,            â”‚         â”‚    role,             â”‚           â”‚
â”‚  â”‚    email,           â”‚         â”‚    email,            â”‚           â”‚
â”‚  â”‚    password: hash,  â”‚         â”‚    password: hash,   â”‚           â”‚
â”‚  â”‚    googleId         â”‚         â”‚    companyName,      â”‚           â”‚
â”‚  â”‚  }                  â”‚         â”‚    gst, ...          â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  }                   â”‚           â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Authentication Flow Sequence

### Registration Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚                  â”‚ Frontend â”‚                  â”‚ Backend â”‚                 â”‚ Database â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚  Enter credentials        â”‚                             â”‚                           â”‚
   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚  POST /api/auth/register    â”‚                           â”‚
   â”‚                           â”‚  { email, password }        â”‚                           â”‚
   â”‚                           â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  Check if email exists    â”‚
   â”‚                           â”‚                             â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  Email not found          â”‚
   â”‚                           â”‚                             â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  Hash password            â”‚
   â”‚                           â”‚                             â”‚  (bcrypt.hash)            â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  Create new user          â”‚
   â”‚                           â”‚                             â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  User created             â”‚
   â”‚                           â”‚                             â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  Generate JWT token       â”‚
   â”‚                           â”‚                             â”‚  jwt.sign({ id, email })  â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚  { token, user }            â”‚                           â”‚
   â”‚                           â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚  Store token & user data    â”‚                           â”‚
   â”‚                           â”‚  Navigate to /home          â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚  âœ… Registration Success  â”‚                             â”‚                           â”‚
   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
```

---

### Login Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚                  â”‚ Frontend â”‚                  â”‚ Backend â”‚                 â”‚ Database â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚  Enter email & password   â”‚                             â”‚                           â”‚
   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚  POST /api/auth/login       â”‚                           â”‚
   â”‚                           â”‚  { email, password }        â”‚                           â”‚
   â”‚                           â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  Find user by email       â”‚
   â”‚                           â”‚                             â”‚  (check User collection)  â”‚
   â”‚                           â”‚                             â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  User found with          â”‚
   â”‚                           â”‚                             â”‚  hashed password          â”‚
   â”‚                           â”‚                             â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  bcrypt.compare(          â”‚
   â”‚                           â”‚                             â”‚    entered_password,      â”‚
   â”‚                           â”‚                             â”‚    stored_hash            â”‚
   â”‚                           â”‚                             â”‚  )                        â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  âœ… Passwords match       â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  Generate JWT token       â”‚
   â”‚                           â”‚                             â”‚  jwt.sign({ id, email })  â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚  { token, user }            â”‚                           â”‚
   â”‚                           â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚  Store token & user data    â”‚                           â”‚
   â”‚                           â”‚  Show success toast         â”‚                           â”‚
   â”‚                           â”‚  Navigate to /home          â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚  âœ… Login Success          â”‚                             â”‚                           â”‚
   â”‚  Redirected to /home      â”‚                             â”‚                           â”‚
   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
```

---

### Login Flow - Wrong Password

```
â”Œâ”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚                  â”‚ Frontend â”‚                  â”‚ Backend â”‚                 â”‚ Database â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚  Enter wrong password     â”‚                             â”‚                           â”‚
   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚  POST /api/auth/login       â”‚                           â”‚
   â”‚                           â”‚  { email, wrong_password }  â”‚                           â”‚
   â”‚                           â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  Find user by email       â”‚
   â”‚                           â”‚                             â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  User found               â”‚
   â”‚                           â”‚                             â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  bcrypt.compare(          â”‚
   â”‚                           â”‚                             â”‚    wrong_password,        â”‚
   â”‚                           â”‚                             â”‚    stored_hash            â”‚
   â”‚                           â”‚                             â”‚  )                        â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚  âŒ Passwords don't match â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚  { error: "Invalid          â”‚                           â”‚
   â”‚                           â”‚    credentials" }           â”‚                           â”‚
   â”‚                           â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚                           â”‚  Show error toast           â”‚                           â”‚
   â”‚                           â”‚  Stay on login page         â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
   â”‚  âŒ Login Failed           â”‚                             â”‚                           â”‚
   â”‚  Error message shown      â”‚                             â”‚                           â”‚
   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                             â”‚                           â”‚
   â”‚                           â”‚                             â”‚                           â”‚
```

---

## Password Security Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Password Hashing Process                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Registration:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

User enters: "mypassword123"
                 â”‚
                 â–¼
     bcrypt.genSalt(10)
                 â”‚
                 â–¼
   Salt generated: "$2a$10$abcdefgh..."
                 â”‚
                 â–¼
bcrypt.hash("mypassword123", salt)
                 â”‚
                 â–¼
Hashed: "$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy"
                 â”‚
                 â–¼
         Store in database
         (NEVER store plain password)


Login:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

User enters: "mypassword123"
                 â”‚
                 â–¼
    Find user in database
                 â”‚
                 â–¼
Get stored hash: "$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy"
                 â”‚
                 â–¼
bcrypt.compare("mypassword123", stored_hash)
                 â”‚
                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚                              â”‚
                 â–¼                              â–¼
            Returns TRUE                  Returns FALSE
        (passwords match)             (passwords don't match)
                 â”‚                              â”‚
                 â–¼                              â–¼
         Generate JWT token              Return error
         Login success âœ…                "Invalid credentials" âŒ
```

---

## JWT Token Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      JWT Token                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Header (Algorithm & Type)                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚ {                            â”‚                          â”‚
â”‚  â”‚   "alg": "HS256",            â”‚                          â”‚
â”‚  â”‚   "typ": "JWT"               â”‚                          â”‚
â”‚  â”‚ }                            â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                  â”‚                                          â”‚
â”‚                  â–¼                                          â”‚
â”‚  Payload (User Data)                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚ {                            â”‚                          â”‚
â”‚  â”‚   "id": "65a1b2c3...",       â”‚                          â”‚
â”‚  â”‚   "email": "user@email.com", â”‚                          â”‚
â”‚  â”‚   "role": "user",            â”‚                          â”‚
â”‚  â”‚   "iat": 1638360000,         â”‚  (issued at)            â”‚
â”‚  â”‚   "exp": 1638964800          â”‚  (expires in 7 days)    â”‚
â”‚  â”‚ }                            â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                  â”‚                                          â”‚
â”‚                  â–¼                                          â”‚
â”‚  Signature (Verification)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚ HMACSHA256(                  â”‚                          â”‚
â”‚  â”‚   base64(header) + "." +     â”‚                          â”‚
â”‚  â”‚   base64(payload),           â”‚                          â”‚
â”‚  â”‚   JWT_SECRET                 â”‚                          â”‚
â”‚  â”‚ )                            â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                             â”‚
â”‚  Result: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6...â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Usage in API Requests:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

---

## Data Flow Summary

```
1. USER ACTION
   â”‚
   â”œâ”€â–¶ Register: email + password â†’ Backend
   â”‚   â””â”€â–¶ Hash password â†’ Store in DB â†’ Return token
   â”‚
   â”œâ”€â–¶ Login: email + password â†’ Backend
   â”‚   â””â”€â–¶ Find user â†’ Compare passwords â†’ Return token
   â”‚
   â””â”€â–¶ Access protected route: token â†’ Backend
       â””â”€â–¶ Verify token â†’ Return user data

2. PASSWORD SECURITY
   â”‚
   â”œâ”€â–¶ Never stored in plain text
   â”œâ”€â–¶ Always hashed with bcrypt
   â”œâ”€â–¶ Never returned in API responses
   â””â”€â–¶ Compared securely with bcrypt.compare()

3. TOKEN MANAGEMENT
   â”‚
   â”œâ”€â–¶ Generated on successful login
   â”œâ”€â–¶ Stored in frontend (localStorage/context)
   â”œâ”€â–¶ Sent with each authenticated request
   â”œâ”€â–¶ Verified on backend
   â””â”€â–¶ Expires after 7 days
```

---

## File Structure & Responsibilities

```
backend/
â”œâ”€â”€ server.js                  â†’ Express app setup & middleware
â”œâ”€â”€ config/
â”‚   â””â”€â”€ db.js                  â†’ MongoDB connection
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ User.js                â†’ User schema (regular users)
â”‚   â””â”€â”€ Vendor.js              â†’ Vendor schema (vendors/businesses)
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ authController.js      â†’ Authentication business logic
â”‚       â”œâ”€â”€ register()         â†’ Create new user
â”‚       â”œâ”€â”€ login()            â†’ Authenticate user
â”‚       â”œâ”€â”€ googleLogin()      â†’ OAuth (mock)
â”‚       â””â”€â”€ me()               â†’ Get current user
â””â”€â”€ routes/
    â””â”€â”€ authRoutes.js          â†’ Route definitions

frontend/
â””â”€â”€ src/
    â”œâ”€â”€ components/
    â”‚   â””â”€â”€ LoginCard.jsx      â†’ Login form UI
    â”œâ”€â”€ context/
    â”‚   â””â”€â”€ AuthContext.jsx    â†’ Auth state management
    â””â”€â”€ pages/
        â””â”€â”€ Home.jsx           â†’ Protected home page
```

---

## Key Security Principles

```
âœ… Defense in Depth
   â”œâ”€â–¶ Frontend validation (UX)
   â”œâ”€â–¶ Backend validation (Security)
   â”œâ”€â–¶ Database constraints (Data integrity)
   â””â”€â–¶ Token verification (Authorization)

âœ… Password Security
   â”œâ”€â–¶ Hashed with bcrypt (10 rounds)
   â”œâ”€â–¶ Salted (random salt per password)
   â”œâ”€â–¶ Never reversible
   â””â”€â–¶ Secure comparison (bcrypt.compare)

âœ… Token Security
   â”œâ”€â–¶ Signed with secret key
   â”œâ”€â–¶ Time-limited (7 days)
   â”œâ”€â–¶ Contains minimal data
   â””â”€â–¶ Verified on every request

âœ… API Security
   â”œâ”€â–¶ CORS configured
   â”œâ”€â–¶ Input validation
   â”œâ”€â–¶ Error messages don't leak info
   â””â”€â–¶ HTTPS in production (recommended)
```

This architecture ensures secure, scalable user authentication! ğŸ”’âœ¨
